import{c as $,j as e}from"./index-zP8ArnZ0.js";import{a as m,P as Xa,c as Ja,F as Za,o as we,p as Qa,G as et,q as at,s as da,t as ua,u as tt,h as V,R as Ne,l as st,X as ce,E as nt,m as it,v as ma,f as lt,I as rt,U as ct,T as ot,j as dt,b as ut,C as mt}from"./icons-CLN19_QX.js";import{u as ht}from"./index-DsAOVHfT.js";import"./vendor-V74KKV6y.js";const Se=[{name:"å…¨å“¡",color:"#E5A500"},{name:"G-Dragon",color:"#ed609f"},{name:"T.O.P",color:"#8fc126"},{name:"å¤ªé™½",color:"#d7171e"},{name:"å¤§è²",color:"#f4e727"},{name:"å‹åˆ©",color:"#1e92c6"}],F=[{id:"post",label:"è²¼æ–‡",icon:"ðŸ“·",color:"#E1306C"},{id:"story",label:"Story",icon:"â­•",color:"#833AB4"},{id:"reels",label:"Reels",icon:"ðŸŽ¬",color:"#F77737"}],pt={"G-Dragon":"xxxibgdrgn","T.O.P":"ttt",å¤ªé™½:"__youngbae__",å¤§è²:"d_lable_official",å‹åˆ©:"",å…¨å“¡:"bigbangofficial"};function oe(d){var u;return((u=Se.find(C=>C.name===d))==null?void 0:u.color)||"#E5A500"}function ft(){return"s-"+Date.now()}function gt(d){return/(?:youtube\.com\/(?:watch|embed|shorts)|youtu\.be\/)/i.test(d)}function pa(d){const u=d.match(/(?:youtube\.com\/(?:watch\?v=|embed\/|shorts\/)|youtu\.be\/)([a-zA-Z0-9_-]{11})/);return u?u[1]:null}function ke(d){const u=pa(d);return u?`https://img.youtube.com/vi/${u}/hqdefault.jpg`:null}function ha(d){const u=d.backupUrl||d.thumbnailBackupUrl;return u!=null&&u.includes("cloudinary.com/")?u.replace("/upload/","/upload/w_400,q_auto,f_auto/"):u||d.thumbnail||d.url}function bt(d){var u;return(u=d.backupUrl)!=null&&u.includes("cloudinary.com/")?d.backupUrl.replace("/upload/","/upload/w_1080,q_auto,f_auto/"):d.backupUrl||d.url}function Ue(d){if(!d)return"";const u=new Date(d);return`${u.getFullYear()}/${u.getMonth()+1}/${u.getDate()}`}function xt(d,u){if(!d||!u)return Ue(d);const[C,y,w]=d.split("-");return`${Number(C)}/${Number(y)}/${Number(w)} ${u}`}const fa=$.SOCIAL_IMGBB_API_KEY;async function jt(d){const u=new FormData;u.append("image",d);const y=await(await fetch(`https://api.imgbb.com/1/upload?key=${fa}`,{method:"POST",body:u})).json();if(y.success)return y.data.url;throw new Error("ä¸Šå‚³å¤±æ•—")}async function de(d){const u=new FormData;u.append("image",d);const y=await(await fetch(`https://api.imgbb.com/1/upload?key=${fa}`,{method:"POST",body:u})).json();if(y.success)return y.data.url;throw new Error("ä¸Šå‚³å¤±æ•—")}async function ue(d){var y;const u=$.SOCIAL_CLOUDINARY_CLOUD_NAME,C=$.SOCIAL_CLOUDINARY_PRESET;try{const w=new FormData;w.append("file",d),w.append("upload_preset",C);const L=await(await fetch(`https://api.cloudinary.com/v1_1/${u}/image/upload`,{method:"POST",body:w})).json();if(L.secure_url)return console.log("âœ… Cloudinary å‚™ä»½æˆåŠŸ:",L.secure_url),L.secure_url;throw new Error(((y=L.error)==null?void 0:y.message)||"ä¸Šå‚³å¤±æ•—")}catch(w){return console.warn("Cloudinary å‚™ä»½å¤±æ•—:",w.message),null}}function yt(d){if(!d)return"å…¨å“¡";const u=d.toLowerCase();for(const[C,y]of Object.entries(pt))if(y&&u===y.toLowerCase())return C;return"å…¨å“¡"}async function Ce(d){try{const u=`${$.IG_SCRAPER_URL}/scrape?url=${encodeURIComponent(d)}`;return await(await fetch(u)).json()}catch(u){return console.error("IG æŠ“å–å¤±æ•—:",u),{success:!1,error:u.message}}}function vt({isAdmin:d,onBack:u,currentPage:C,setCurrentPage:y}){var aa,ta,sa,na,ia,la;const[w,P]=m.useState([]),[L,Te]=m.useState(!0),[$e,Ie]=m.useState(!1),[X,Me]=m.useState(null),[Ae,W]=m.useState(!1),[J,ga]=m.useState("all"),[Z,ba]=m.useState("all"),[H,xa]=m.useState(!1),[Q,ja]=m.useState(!1),[ee,ya]=m.useState(""),[B,Be]=m.useState("grid"),[M,va]=m.useState({}),[me,Pe]=m.useState(!1),[ze,De]=m.useState({current:0,total:0}),[wa,z]=m.useState(!1),[S,_e]=m.useState(null),[p,v]=m.useState({type:"post",member:"å…¨å“¡",date:new Date().toISOString().split("T")[0],time:"",igUrl:"",caption:"",media:[],notes:""}),[Ee,Oe]=m.useState(!1),[c,D]=m.useState(null),[A,_]=m.useState(0),[E,Fe]=m.useState(!1),[O,G]=m.useState([]),[Le,Ge]=m.useState(!1),[Re,Ye]=m.useState({current:0,total:0}),[Na,Ve]=m.useState(null),R=m.useRef(!1),[I,he]=m.useState(null),pe=m.useRef(null),[K,fe]=m.useState(()=>window.innerWidth<500?2:Math.max(2,Math.floor(Math.min(900,window.innerWidth)/280)));m.useEffect(()=>{ka()},[]);async function ka(){Te(!0);try{const a=await fetch(`${$.API_URL}/social`);if(!a.ok)throw new Error("è¼‰å…¥å¤±æ•—");const s=await a.json();P(s)}catch(a){console.error("è¼‰å…¥å¤±æ•—",a),f("è¼‰å…¥å¤±æ•—","error")}finally{Te(!1)}}async function Ca(a){const s=await fetch(`${$.API_URL}/social`,{method:"POST",headers:{"Content-Type":"application/json","X-API-Key":$.API_KEY},body:JSON.stringify(a)});if(!s.ok)throw new Error("å»ºç«‹å¤±æ•—");return s.json()}async function ge(a){const s=await fetch(`${$.API_URL}/social/${a.id}`,{method:"PUT",headers:{"Content-Type":"application/json","X-API-Key":$.API_KEY},body:JSON.stringify(a)});if(!s.ok)throw new Error("æ›´æ–°å¤±æ•—");return s.json()}async function Sa(a){const s=await fetch(`${$.API_URL}/social/${a}`,{method:"DELETE",headers:{"X-API-Key":$.API_KEY}});if(!s.ok)throw new Error("åˆªé™¤å¤±æ•—");return s.json()}function f(a,s="success"){Me({msg:a,type:s}),setTimeout(()=>Me(null),2500)}function ae({title:a,content:s,type:n="warning",confirmText:t="ç¢ºå®š",cancelText:o="å–æ¶ˆ"}){return new Promise(l=>{he({title:a,content:s,type:n,confirmText:t,cancelText:o,onConfirm:()=>{he(null),l(!0)},onCancel:()=>{he(null),l(!1)}})})}function Ua(a){var s;return(s=a.media)==null?void 0:s.some(n=>n.type==="video"||n.type==="youtube")}function Ta(a){var s;return((s=M[a.id])==null?void 0:s.length)>0}async function q(a){if(!a)return!1;try{const s=new AbortController,n=setTimeout(()=>s.abort(),1e4),t=await fetch(a,{method:"HEAD",mode:"cors",signal:s.signal});return clearTimeout(n),t.ok?!0:(console.log(`âŒ åœ–ç‰‡æª¢æŸ¥å¤±æ•— (HTTP ${t.status}): ${a}`),!1)}catch{return new Promise(n=>{const t=new window.Image,o=setTimeout(()=>{t.src="",n(!1)},1e4);t.onload=()=>{clearTimeout(o),t.naturalWidth===0||t.naturalHeight===0?n(!1):n(!0)},t.onerror=()=>{clearTimeout(o),n(!1)},t.src=a})}}async function $a(){var t;Pe(!0),De({current:0,total:w.length});const a={};let s=0;for(const o of w){const l=[];if(((t=o.media)==null?void 0:t.length)>0)for(let r=0;r<o.media.length;r++){const x=o.media[r],g=x.type==="video"?x.thumbnail:x.url;g&&(await q(g)||l.push(r))}l.length>0&&(a[o.id]=l),s++,De({current:s,total:w.length})}va(a),Pe(!1);const n=Object.keys(a).length;n>0?f(`æª¢æŸ¥å®Œæˆï¼š${n} ç­†æœ‰å£žåœ–`,"error"):f("æª¢æŸ¥å®Œæˆï¼šæ²’æœ‰ç™¼ç¾å£žåœ– âœ…")}const N=m.useMemo(()=>w.filter(a=>{var s;return!(J!=="all"&&a.member!==J||Z!=="all"&&a.type!==Z||H&&!Ua(a)||Q&&!Ta(a)||ee&&!((s=a.caption)!=null&&s.toLowerCase().includes(ee.toLowerCase())))}).sort((a,s)=>new Date(s.date)-new Date(a.date)),[w,J,Z,H,Q,ee,M]);m.useEffect(()=>{const a=pe.current;if(!a)return;const s=()=>{if(B!=="grid"){fe(1);return}const t=Math.min(a.clientWidth,window.innerWidth);if(t<500){fe(2);return}fe(Math.max(2,Math.floor(t/280)))};s();const n=new ResizeObserver(s);return n.observe(a),()=>n.disconnect()},[B]);const Ia=m.useMemo(()=>Math.ceil(N.length/K),[N.length,K]),be=ht({count:Ia,getScrollElement:()=>pe.current,estimateSize:()=>B==="grid"?340:120,overscan:3,gap:B==="grid"?16:10});function We(){_e(null),v({type:"post",member:"å…¨å“¡",date:new Date().toISOString().split("T")[0],time:"",igUrl:"",caption:"",media:[],notes:""}),z(!0)}function Ma(a){_e(a),v({type:a.type,member:a.member,date:a.date,time:a.time||"",igUrl:a.igUrl||"",caption:a.caption||"",media:a.media||[],notes:a.notes||""}),z(!0)}function Aa(a){D(a),_(0)}function Ba(){const a=N.findIndex(s=>s.id===(c==null?void 0:c.id));a>0&&(D(N[a-1]),_(0))}function Pa(){const a=N.findIndex(s=>s.id===(c==null?void 0:c.id));a<N.length-1&&(D(N[a+1]),_(0))}function xe(){return N.findIndex(a=>a.id===(c==null?void 0:c.id))}const[He,te]=m.useState(new Set);function se(a){return He.has(a)}async function za(){var n,t,o,l;if(!(c!=null&&c.igUrl)){f("æ­¤è²¼æ–‡æ²’æœ‰ IG é€£çµ","error");return}if(se(c.id)){f("æ­¤è²¼æ–‡æ­£åœ¨åŒæ­¥ä¸­...","info");return}const a={...c},s=c.id;te(r=>new Set(r).add(s));try{const r=await Ce(a.igUrl);if(!r.success||!((n=r.media)!=null&&n.length)){if(!await ae({title:"âš ï¸ æŠ“å–å¤±æ•—",type:"warning",confirmText:"æ¸…ç©ºåª’é«”",cancelText:"å–æ¶ˆ",content:e.jsxs("div",{className:"confirm-content",children:[e.jsx("p",{children:"å¯èƒ½åŽŸå› ï¼š"}),e.jsxs("ul",{children:[e.jsx("li",{children:"IG è²¼æ–‡å·²è¢«åˆªé™¤"}),e.jsx("li",{children:"IG API æš«æ™‚ç„¡æ³•å­˜å–"}),e.jsx("li",{children:"ç¶²è·¯é€£ç·šå•é¡Œ"})]}),e.jsx("p",{className:"confirm-warning",children:"æ˜¯å¦ä»è¦æ¸…ç©ºæ­¤è²¼æ–‡çš„åª’é«”è³‡æ–™ï¼Ÿ"})]})})){te(k=>{const T=new Set(k);return T.delete(s),T});return}}else{const j=((t=a.media)==null?void 0:t.length)||0,k=((o=r.media)==null?void 0:o.length)||0,T=(a.caption||"").trim(),re=(r.caption||"").trim(),ra=j!==k,ca=T!==re&&re!=="";if(ra||ca){const Ha=T.substring(0,80)+(T.length>80?"...":""),Ka=re.substring(0,80)+(re.length>80?"...":"");if(!await ae({title:"ðŸ“ è³‡æ–™è®Šæ›´ç¢ºèª",type:"info",confirmText:"è¦†è“‹",cancelText:"å–æ¶ˆ",content:e.jsxs("div",{className:"confirm-content",children:[e.jsx("p",{children:"æŠ“å–åˆ°çš„è³‡æ–™èˆ‡ç¾æœ‰è³‡æ–™ä¸åŒï¼š"}),ra&&e.jsxs("div",{className:"diff-item",children:[e.jsx("span",{className:"diff-label",children:"ðŸ“· åª’é«”æ•¸é‡"}),e.jsxs("div",{className:"diff-values",children:[e.jsxs("span",{className:"diff-old",children:[j," å¼µ"]}),e.jsx("span",{className:"diff-arrow",children:"â†’"}),e.jsxs("span",{className:"diff-new",children:[k," å¼µ"]})]})]}),ca&&e.jsxs("div",{className:"diff-item",children:[e.jsx("span",{className:"diff-label",children:"ðŸ“ å…§å®¹"}),e.jsxs("div",{className:"diff-text",children:[e.jsx("div",{className:"diff-old",children:Ha||"(ç©º)"}),e.jsx("div",{className:"diff-new",children:Ka})]})]}),e.jsx("p",{className:"confirm-question",children:"ç¢ºå®šè¦è¦†è“‹å—Žï¼Ÿ"})]})})){te(qa=>{const oa=new Set(qa);return oa.delete(s),oa}),f("å·²å–æ¶ˆåŒæ­¥");return}}}f("åŒæ­¥ä¸­ï¼Œæª¢æŸ¥ä¸¦ä¸Šå‚³åœ–ç‰‡...","info");const x=((l=r.media)==null?void 0:l.length)>0?await ea(r.media,a.media||[]):[],g=(a.media||[]).filter(j=>j.type==="youtube"),b=[...x,...g];let i=a.date,h=a.time||"";if(r.date){const j=new Date(r.date),k=new Date(j.getTime()+480*60*1e3);i=`${k.getUTCFullYear()}-${String(k.getUTCMonth()+1).padStart(2,"0")}-${String(k.getUTCDate()).padStart(2,"0")}`,h=`${String(k.getUTCHours()).padStart(2,"0")}:${String(k.getUTCMinutes()).padStart(2,"0")}`}const U={...a,media:b,caption:r.caption||a.caption,date:i,time:h,updatedAt:Date.now()};P(j=>{const k=j.map(T=>T.id===s?U:T);return ge(U).catch(T=>console.warn("D1 å„²å­˜å¤±æ•—:",T)),k}),D(j=>(j==null?void 0:j.id)===s?U:j),_(0),x.length>0?f(`âœ… åŒæ­¥å®Œæˆï¼š${x.length} å€‹åª’é«”`):f("å·²æ¸…ç©ºåª’é«”è³‡æ–™","info")}catch(r){console.error("åŒæ­¥å¤±æ•—:",r),f("âŒ åŒæ­¥å¤±æ•—ï¼š"+r.message,"error")}finally{te(r=>{const x=new Set(r);return x.delete(s),x})}}function Da(){c&&(Ma(c),D(null))}const[je,ne]=m.useState(!1),[Ke,ie]=m.useState(""),[qe,le]=m.useState(0),[Xe,Y]=m.useState(!1),[ye,ve]=m.useState("");async function Je(){var a,s;if(p.igUrl){ne(!0),ie("æŠ“å–ä¸­...");try{const n=await Ce(p.igUrl);if(n.success&&((a=n.media)==null?void 0:a.length)>0){const t=yt((s=n.owner)==null?void 0:s.username);let o=p.date,l="";if(n.date){const i=new Date(n.date),h=new Date(i.getTime()+480*60*1e3);o=`${h.getUTCFullYear()}-${String(h.getUTCMonth()+1).padStart(2,"0")}-${String(h.getUTCDate()).padStart(2,"0")}`,l=`${String(h.getUTCHours()).padStart(2,"0")}:${String(h.getUTCMinutes()).padStart(2,"0")}`}const r=n.media||[],x=r.map((i,h)=>({url:i.url||i.thumbnail,type:i.type,thumbnail:i.thumbnail||null,uploading:i.type==="image",thumbnailUploading:i.type==="video"&&i.thumbnail,originalUrl:i.url,originalThumbnail:i.thumbnail,index:h}));v(i=>({...i,type:n.type||i.type,member:t,date:o,time:l||i.time,caption:n.caption||i.caption,media:x})),ne(!1),ie(""),Y(!1),f(`âœ… å·²æŠ“å– ${r.length} å€‹åª’é«”ï¼ŒèƒŒæ™¯ä¸Šå‚³ä¸­...`);const g=x.filter(i=>i.type==="image"),b=x.filter(i=>i.type==="video"&&i.thumbnail);le(g.length+b.length);for(const i of g)Ze(i.originalUrl,i.index);for(const i of b)Ea(i.originalThumbnail,i.index)}else{const t=p.igUrl.match(/instagram\.com\/p\//),o=p.igUrl.match(/instagram\.com\/(?:reel|reels)\//);let l="post";o&&(l="reels"),v(r=>({...r,type:l})),Y(!0),f("âš ï¸ è‡ªå‹•æŠ“å–å¤±æ•—ï¼Œè«‹æ‰‹å‹•è¼¸å…¥åª’é«”ç¶²å€","info"),ne(!1),ie("")}}catch(n){console.error("è§£æžå¤±æ•—",n),Y(!0),f("âš ï¸ æŠ“å–å¤±æ•—ï¼Œè«‹æ‰‹å‹•è¼¸å…¥åª’é«”ç¶²å€","error"),ne(!1),ie("")}}}async function _a(){if(!ye.trim())return;const a=ye.split(`
`).map(t=>t.trim()).filter(t=>t&&(t.startsWith("http")||t.startsWith("//")));if(a.length===0){f("è«‹è¼¸å…¥æœ‰æ•ˆçš„ç¶²å€","error");return}const s=a.map((t,o)=>{if(gt(t))return{url:t,type:"youtube",thumbnail:ke(t),index:p.media.length+o};const l=/\.(mp4|mov|webm|m4v)/i.test(t)||t.includes("video");return{url:t,type:l?"video":"image",uploading:!l,originalUrl:t,index:p.media.length+o}});v(t=>({...t,media:[...t.media,...s]}));const n=s.filter(t=>t.type==="image");le(t=>t+n.length);for(const t of n)Ze(t.originalUrl,t.index);ve(""),Y(!1),f(`å·²æ–°å¢ž ${a.length} å€‹åª’é«”`)}async function Ze(a,s){try{const[n,t]=await Promise.all([de(a),ue(a)]);v(o=>({...o,media:o.media.map((l,r)=>r===s?{...l,url:n,backupUrl:t,uploading:!1}:l)})),t&&console.log(`âœ… åœ–ç‰‡ ${s+1} é›™é‡å‚™ä»½å®Œæˆ`)}catch(n){console.warn(`åœ–ç‰‡ ${s+1} ä¸Šå‚³å¤±æ•—`,n),v(t=>({...t,media:t.media.map((o,l)=>l===s?{...o,uploading:!1,uploadFailed:!0}:o)}))}finally{le(n=>n-1)}}async function Ea(a,s){try{const[n,t]=await Promise.all([de(a),ue(a)]);v(o=>({...o,media:o.media.map((l,r)=>r===s?{...l,thumbnail:n,thumbnailBackupUrl:t,thumbnailUploading:!1}:l)})),t&&console.log(`âœ… å½±ç‰‡ ${s+1} ç¸®åœ–é›™é‡å‚™ä»½å®Œæˆ`)}catch(n){console.warn(`å½±ç‰‡ ${s+1} ç¸®åœ–ä¸Šå‚³å¤±æ•—`,n),v(t=>({...t,media:t.media.map((o,l)=>l===s?{...o,thumbnailUploading:!1,thumbnailFailed:!0}:o)}))}finally{le(n=>n-1)}}async function Oa(a){const s=Array.from(a.target.files);if(s.length){Oe(!0);try{const n=[];for(const t of s)if(t.type.startsWith("video/")){const l=URL.createObjectURL(t);n.push({url:l,type:"video",localFile:t})}else{const l=await jt(t);n.push({url:l,type:"image"})}v(t=>({...t,media:[...t.media,...n]})),f(`å·²æ–°å¢ž ${n.length} å€‹æª”æ¡ˆ`)}catch(n){console.error("ä¸Šå‚³å¤±æ•—",n),f("ä¸Šå‚³å¤±æ•—","error")}finally{Oe(!1)}}}function Fa(a){v(s=>({...s,media:s.media.filter((n,t)=>t!==a)}))}async function La(){if(!p.date||!p.member){f("è«‹å¡«å¯«å¿…è¦æ¬„ä½","error");return}if(p.media.some(n=>n.uploading)&&!await ae({title:"âš ï¸ ä¸Šå‚³æœªå®Œæˆ",type:"warning",confirmText:"ä»è¦å„²å­˜",cancelText:"ç­‰å¾…ä¸Šå‚³",content:e.jsxs("div",{className:"confirm-content",children:[e.jsx("p",{children:"é‚„æœ‰åœ–ç‰‡æ­£åœ¨ä¸Šå‚³ä¸­ï¼Œç¢ºå®šè¦ç¾åœ¨å„²å­˜å—Žï¼Ÿ"}),e.jsx("p",{className:"confirm-warning",children:"æœªå®Œæˆä¸Šå‚³çš„åœ–ç‰‡å¯èƒ½ç„¡æ³•æ­£å¸¸é¡¯ç¤º"})]})}))return;const s={id:(S==null?void 0:S.id)||ft(),type:p.type,member:p.member,date:p.date,time:p.time,igUrl:p.igUrl,caption:p.caption,media:p.media.map(n=>({url:n.url,type:n.type,...n.backupUrl&&{backupUrl:n.backupUrl},...n.thumbnail&&{thumbnail:n.thumbnail},...n.thumbnailBackupUrl&&{thumbnailBackupUrl:n.thumbnailBackupUrl}})),notes:p.notes,createdAt:(S==null?void 0:S.createdAt)||Date.now(),updatedAt:Date.now()};Ie(!0);try{S?(await ge(s),P(w.map(n=>n.id===S.id?s:n))):(await Ca(s),P([s,...w])),f("å·²å„²å­˜"),z(!1)}catch(n){console.error("å„²å­˜å¤±æ•—",n),f("å„²å­˜å¤±æ•—","error")}finally{Ie(!1)}}async function Ga(a){if(await ae({title:"ðŸ—‘ï¸ åˆªé™¤ç¢ºèª",type:"danger",confirmText:"åˆªé™¤",cancelText:"å–æ¶ˆ",content:e.jsxs("div",{className:"confirm-content",children:[e.jsx("p",{children:"ç¢ºå®šè¦åˆªé™¤é€™ç­†å‚™ä»½å—Žï¼Ÿ"}),e.jsx("p",{className:"confirm-warning",children:"æ­¤æ“ä½œç„¡æ³•å¾©åŽŸ"})]})}))try{await Sa(a),P(w.filter(n=>n.id!==a)),f("å·²åˆªé™¤")}catch(n){console.error("åˆªé™¤å¤±æ•—",n),f("åˆªé™¤å¤±æ•—","error")}}function Qe(a){G(s=>s.includes(a)?s.filter(n=>n!==a):[...s,a])}function Ra(){O.length===N.length?G([]):G(N.map(a=>a.id))}async function ea(a,s=[]){var o,l,r,x;const n=[],t=[];for(let g=0;g<a.length;g++){const b=a[g],i=s[g];if(b.type==="image"){if((i==null?void 0:i.type)==="image"){if((o=i==null?void 0:i.url)!=null&&o.includes("i.ibb.co")&&await q(i.url)){console.log(`âœ… åœ–ç‰‡ ${g+1} ImgBB å‚™ä»½å¯ç”¨ï¼Œè·³éŽä¸Šå‚³`),n.push({...i});continue}if((l=i==null?void 0:i.backupUrl)!=null&&l.includes("cloudinary")&&await q(i.backupUrl)){console.log(`âœ… åœ–ç‰‡ ${g+1} Cloudinary å‚™ä»½å¯ç”¨ï¼Œåˆ‡æ›ä½¿ç”¨`),n.push({url:i.backupUrl,type:"image",backupUrl:i.backupUrl});continue}console.log(`âš ï¸ åœ–ç‰‡ ${g+1} æ‰€æœ‰å‚™ä»½éƒ½å¤±æ•ˆï¼Œé‡æ–°ä¸Šå‚³`)}try{console.log(`ðŸ“¤ ä¸Šå‚³åœ–ç‰‡ ${g+1}...`);const U={url:await de(b.url),type:"image"};n.push(U);const j=n.length-1;t.push(ue(b.url).then(k=>{k&&(n[j].backupUrl=k)}).catch(k=>console.warn("Cloudinary èƒŒæ™¯ä¸Šå‚³å¤±æ•—:",k)))}catch(h){console.warn("åœ–ç‰‡ä¸Šå‚³å¤±æ•—:",h),n.push({url:b.url,type:"image"})}}else if(b.type==="video"){const h={url:b.url,type:"video"};if(b.thumbnail){if((i==null?void 0:i.type)==="video"){if((r=i==null?void 0:i.thumbnail)!=null&&r.includes("i.ibb.co")&&await q(i.thumbnail)){console.log(`âœ… å½±ç‰‡ ${g+1} ç¸®åœ– ImgBB å‚™ä»½å¯ç”¨ï¼Œè·³éŽä¸Šå‚³`),h.thumbnail=i.thumbnail,i.thumbnailBackupUrl&&(h.thumbnailBackupUrl=i.thumbnailBackupUrl),n.push(h);continue}if((x=i==null?void 0:i.thumbnailBackupUrl)!=null&&x.includes("cloudinary")&&await q(i.thumbnailBackupUrl)){console.log(`âœ… å½±ç‰‡ ${g+1} ç¸®åœ– Cloudinary å‚™ä»½å¯ç”¨ï¼Œåˆ‡æ›ä½¿ç”¨`),h.thumbnail=i.thumbnailBackupUrl,h.thumbnailBackupUrl=i.thumbnailBackupUrl,n.push(h);continue}console.log(`âš ï¸ å½±ç‰‡ ${g+1} ç¸®åœ–æ‰€æœ‰å‚™ä»½éƒ½å¤±æ•ˆï¼Œé‡æ–°ä¸Šå‚³`)}try{console.log(`ðŸ“¤ ä¸Šå‚³å½±ç‰‡ ${g+1} ç¸®åœ–...`);const U=await de(b.thumbnail);h.thumbnail=U,t.push(ue(b.thumbnail).then(j=>{j&&(h.thumbnailBackupUrl=j)}).catch(j=>console.warn("Cloudinary ç¸®åœ–èƒŒæ™¯ä¸Šå‚³å¤±æ•—:",j)))}catch(U){console.warn("ç¸®åœ–ä¸Šå‚³å¤±æ•—:",U),h.thumbnail=b.thumbnail}}n.push(h)}}return t.length>0&&Promise.all(t).then(()=>{console.log("âœ… Cloudinary èƒŒæ™¯ä¸Šå‚³å®Œæˆ")}),n}function Ya(a,s){return a.map((t,o)=>{const l=s[o];return t.type==="video"&&(l==null?void 0:l.type)==="video"?{...t,url:l.url}:(t.type==="image",t)})}function Va(){R.current=!0,f("æ­£åœ¨å–æ¶ˆåŒæ­¥...","info")}async function Wa(){var o;const a=w.filter(l=>O.includes(l.id)&&l.igUrl);if(a.length===0){f("æ²’æœ‰å¯åŒæ­¥çš„é …ç›®ï¼ˆéœ€æœ‰ IG é€£çµï¼‰","error");return}const s=H;R.current=!1,Ge(!0),Ye({current:0,total:a.length});let n=0;for(const l of a){if(R.current)break;Ve(l.id),await new Promise(r=>setTimeout(r,0));try{const r=await Ce(l.igUrl);if(R.current)break;if(r.success&&((o=r.media)==null?void 0:o.length)>0){let x=l.date,g=l.time||"";if(r.date){const i=new Date(r.date),h=new Date(i.getTime()+480*60*1e3);x=`${h.getUTCFullYear()}-${String(h.getUTCMonth()+1).padStart(2,"0")}-${String(h.getUTCDate()).padStart(2,"0")}`,g=`${String(h.getUTCHours()).padStart(2,"0")}:${String(h.getUTCMinutes()).padStart(2,"0")}`}let b;if(s){const i=Ya(l.media,r.media);b={...l,media:i,date:x,time:g,updatedAt:Date.now()},console.log(`âœ… ${l.id} å½±ç‰‡ URL å·²æ›´æ–°ï¼ˆä¿ç•™ thumbnailï¼‰`)}else{const i=await ea(r.media,l.media||[]);if(R.current)break;const h=(l.media||[]).filter(j=>j.type==="youtube"),U=[...i,...h];b={...l,media:U,caption:r.caption||l.caption,date:x,time:g,updatedAt:Date.now()}}P(i=>i.map(h=>h.id===l.id?b:h)),ge(b).catch(i=>console.warn("D1 å„²å­˜å¤±æ•—:",i)),n++,await new Promise(i=>setTimeout(i,0))}}catch(r){console.warn(`åŒæ­¥ ${l.id} å¤±æ•—:`,r)}Ye(r=>({...r,current:r.current+1})),await new Promise(r=>setTimeout(r,0))}const t=R.current;Ve(null),Ge(!1),Fe(!1),G([]),t?f(`å·²å–æ¶ˆåŒæ­¥ï¼ˆå·²å®Œæˆ ${n} ç­†ï¼‰`,"info"):f(s?`å½±ç‰‡åŒæ­¥å®Œæˆï¼š${n}/${a.length} ç­†æˆåŠŸ`:`åŒæ­¥å®Œæˆï¼š${n}/${a.length} ç­†æˆåŠŸ`)}return L?e.jsxs("div",{className:"social-archive-loading",children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("p",{children:"è¼‰å…¥ä¸­..."})]}):e.jsxs("div",{className:"social-archive",children:[e.jsxs("header",{className:"social-header",children:[e.jsx("div",{style:{display:"flex",alignItems:"center",gap:8},children:e.jsx("h1",{children:"ðŸ“± ç¤¾ç¾¤å‚™ä»½"})}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[e.jsx("button",{className:"add-btn",onClick:We,title:"æ–°å¢žå‚™ä»½",children:e.jsx(Xa,{size:20})}),y&&e.jsxs("div",{className:"nav-menu-wrapper",children:[e.jsx("button",{onClick:()=>W(!Ae),className:"hamburger-btn",title:"é¸å–®",children:e.jsx(Ja,{size:18})}),Ae&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"nav-menu-overlay",onClick:()=>W(!1)}),e.jsxs("div",{className:"nav-menu",children:[e.jsxs("button",{className:`nav-menu-item ${C==="timeline"?"active":""}`,onClick:()=>{y("timeline"),W(!1)},children:[e.jsx("span",{children:"ðŸ“…"})," æ™‚é–“è»¸"]}),e.jsxs("button",{className:`nav-menu-item ${C==="social"?"active":""}`,onClick:()=>{y("social"),W(!1)},children:[e.jsx("span",{children:"ðŸ“·"})," ç¤¾ç¾¤å‚™ä»½"]}),e.jsxs("button",{className:`nav-menu-item ${C==="membership"?"active":""}`,onClick:()=>{y("membership"),W(!1)},children:[e.jsx("span",{children:"ðŸ”’"})," æœƒå“¡å‚™ä»½"]})]})]})]})]})]}),e.jsxs("div",{className:"social-filters",children:[e.jsxs("div",{className:"filter-row",children:[e.jsxs("select",{value:J,onChange:a=>ga(a.target.value),className:"filter-select",children:[e.jsx("option",{value:"all",children:"æ‰€æœ‰æˆå“¡"}),Se.map(a=>e.jsx("option",{value:a.name,children:a.name},a.name))]}),e.jsxs("select",{value:Z,onChange:a=>ba(a.target.value),className:"filter-select",children:[e.jsx("option",{value:"all",children:"æ‰€æœ‰é¡žåž‹"}),F.map(a=>e.jsxs("option",{value:a.id,children:[a.icon," ",a.label]},a.id))]}),e.jsxs("button",{className:`filter-video-btn ${H?"active":""}`,onClick:()=>xa(!H),title:"åªé¡¯ç¤ºå«å½±ç‰‡çš„è²¼æ–‡",children:[e.jsx(Za,{size:16}),e.jsx("span",{children:"å½±ç‰‡"})]}),d&&e.jsx("button",{className:`filter-broken-btn ${Q?"active":""}`,onClick:()=>{Object.keys(M).length===0&&!me&&$a(),ja(!Q)},title:"æª¢æŸ¥ä¸¦ç¯©é¸å£žåœ–",disabled:me,children:me?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"mini-spinner"}),e.jsxs("span",{children:[ze.current,"/",ze.total]})]}):e.jsxs(e.Fragment,{children:[e.jsx(we,{size:16}),e.jsxs("span",{children:["å£žåœ–",Object.keys(M).length>0?` (${Object.keys(M).length})`:""]})]})}),e.jsxs("div",{className:"search-box",children:[e.jsx(Qa,{size:16}),e.jsx("input",{type:"text",placeholder:"æœå°‹å…§å®¹...",value:ee,onChange:a=>ya(a.target.value)})]}),e.jsxs("div",{className:"view-toggle",children:[e.jsx("button",{className:B==="grid"?"active":"",onClick:()=>Be("grid"),children:e.jsx(et,{size:16})}),e.jsx("button",{className:B==="list"?"active":"",onClick:()=>Be("list"),children:e.jsx(at,{size:16})})]}),d&&e.jsx("button",{className:`select-mode-btn ${E?"active":""}`,onClick:()=>{Fe(!E),G([])},title:"å‹¾é¸æ¨¡å¼",children:e.jsx(da,{size:16})})]}),e.jsxs("div",{className:"filter-stats",children:["å…± ",N.length," ç­†å‚™ä»½",E&&N.length>0&&e.jsx("button",{className:"select-all-btn",onClick:Ra,children:O.length===N.length?"å–æ¶ˆå…¨é¸":"å…¨é¸"})]})]}),e.jsx("div",{ref:pe,className:"social-content-scroll",children:N.length===0?e.jsxs("div",{className:"empty-state",children:[e.jsx(ua,{size:48}),e.jsx("p",{children:"å°šç„¡å‚™ä»½è³‡æ–™"}),e.jsx("button",{onClick:We,children:"æ–°å¢žç¬¬ä¸€ç­†"})]}):e.jsx("div",{style:{height:be.getTotalSize(),position:"relative"},children:be.getVirtualItems().map(a=>{const s=a.index*K,n=N.slice(s,s+K);return e.jsx("div",{className:`social-content ${B}`,style:{position:"absolute",top:0,left:0,right:0,transform:`translateY(${a.start}px)`,...B==="grid"?{gridTemplateColumns:`repeat(${K}, 1fr)`}:{}},ref:be.measureElement,"data-index":a.index,children:n.map(t=>{var o,l,r,x,g;return e.jsxs("div",{className:`archive-card ${E&&O.includes(t.id)?"selected":""}`,onClick:()=>E?Qe(t.id):Aa(t),children:[E&&e.jsx("div",{className:"card-checkbox",onClick:b=>{b.stopPropagation(),Qe(t.id)},children:O.includes(t.id)?e.jsx(da,{size:20}):e.jsx(tt,{size:20})}),e.jsxs("div",{className:"archive-thumb",children:[(o=t.media)!=null&&o[0]?t.media[0].type==="youtube"?e.jsxs("div",{className:"video-thumb-img",children:[e.jsx("img",{src:t.media[0].thumbnail||ke(t.media[0].url),alt:"",loading:"lazy",width:260,height:260}),e.jsx(V,{size:24,className:"play-overlay"})]}):t.media[0].type==="video"?t.media[0].thumbnail?e.jsxs("div",{className:"video-thumb-img",children:[e.jsx("img",{src:ha(t.media[0]),alt:"",loading:"lazy",width:260,height:260}),e.jsx(V,{size:24,className:"play-overlay"})]}):e.jsxs("div",{className:"video-thumb-auto",children:[e.jsx("video",{src:t.media[0].backupUrl||t.media[0].url,muted:!0,preload:"metadata"}),e.jsx(V,{size:24,className:"play-overlay"})]}):e.jsx("img",{src:ha(t.media[0]),alt:"",loading:"lazy",width:260,height:260}):e.jsx("div",{className:"no-thumb",children:e.jsx("img",{src:"/bigbang-timeline/bigbang-default.png",alt:"BIGBANG"})}),((l=t.media)==null?void 0:l.length)>1&&e.jsxs("span",{className:"media-count",children:["+",t.media.length-1]}),e.jsx("span",{className:"type-badge",style:{background:(r=F.find(b=>b.id===t.type))==null?void 0:r.color},children:(x=F.find(b=>b.id===t.type))==null?void 0:x.icon}),((g=M[t.id])==null?void 0:g.length)>0&&e.jsxs("span",{className:"broken-badge",title:`${M[t.id].length} å¼µåœ–ç‰‡æå£ž`,children:[e.jsx(we,{size:14}),M[t.id].length]}),(He.has(t.id)||Na===t.id)&&e.jsxs("div",{className:"syncing-overlay",children:[e.jsx(Ne,{size:24,className:"spinning"}),e.jsx("span",{children:"åŒæ­¥ä¸­..."})]})]}),e.jsxs("div",{className:"archive-info",children:[e.jsxs("div",{className:"archive-meta",children:[e.jsx("span",{className:"member-tag",style:{background:oe(t.member)+"30",color:oe(t.member)},children:t.member}),e.jsx("span",{className:"date",children:Ue(t.date)})]}),t.caption&&e.jsx("p",{className:"archive-caption",children:t.caption})]})]},t.id)})},a.key)})})}),c&&e.jsxs("div",{className:"modal-overlay view-modal-overlay",onClick:()=>D(null),children:[e.jsxs("div",{className:"post-nav-indicator",onClick:a=>a.stopPropagation(),children:[xe()+1," / ",N.length]}),e.jsx("button",{className:"post-nav-side prev",onClick:a=>{a.stopPropagation(),Ba()},disabled:xe()<=0,title:"ä¸Šä¸€å‰‡",children:e.jsx(st,{size:32})}),e.jsxs("div",{className:"view-modal",onClick:a=>a.stopPropagation(),children:[e.jsx("button",{className:"view-close-btn",onClick:()=>D(null),children:e.jsx(ce,{size:24})}),e.jsx("div",{className:"view-media-area",children:((aa=c.media)==null?void 0:aa.length)>0?e.jsxs(e.Fragment,{children:[((ta=c.media[A])==null?void 0:ta.type)==="youtube"?e.jsx("iframe",{src:`https://www.youtube.com/embed/${pa(c.media[A].url)}?autoplay=1`,allow:"autoplay; encrypted-media",allowFullScreen:!0,className:"view-media view-youtube"}):((sa=c.media[A])==null?void 0:sa.type)==="video"?e.jsx("video",{src:c.media[A].backupUrl||c.media[A].url,controls:!0,autoPlay:!0,className:"view-media"},`${c.id}-${A}`):e.jsx("img",{src:bt(c.media[A]),alt:"",className:"view-media"},`${c.id}-${A}`),c.media.length>1&&e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"media-nav prev",onClick:()=>_(a=>(a-1+c.media.length)%c.media.length),children:"â€¹"}),e.jsx("button",{className:"media-nav next",onClick:()=>_(a=>(a+1)%c.media.length),children:"â€º"}),e.jsx("div",{className:"media-dots",children:c.media.map((a,s)=>e.jsx("span",{className:`dot ${s===A?"active":""}`,onClick:()=>_(s)},s))})]})]}):e.jsx("div",{className:"no-media",children:e.jsx("img",{src:"/bigbang-timeline/bigbang-default.png",alt:"BIGBANG",className:"no-media-img"})})}),e.jsxs("div",{className:"view-info-area",children:[e.jsxs("div",{className:"view-header",children:[e.jsx("span",{className:"member-tag",style:{background:oe(c.member)+"30",color:oe(c.member)},children:c.member}),e.jsxs("span",{className:"type-badge",style:{background:(na=F.find(a=>a.id===c.type))==null?void 0:na.color},children:[(ia=F.find(a=>a.id===c.type))==null?void 0:ia.icon," ",(la=F.find(a=>a.id===c.type))==null?void 0:la.label]}),e.jsx("span",{className:"view-date",children:d&&c.time?xt(c.date,c.time):Ue(c.date)})]}),c.caption&&e.jsx("div",{className:"view-caption",children:e.jsx("p",{children:c.caption})}),c.notes&&e.jsxs("div",{className:"view-notes",children:[e.jsx("strong",{children:"å‚™è¨»ï¼š"}),e.jsx("p",{children:c.notes})]}),e.jsxs("div",{className:"view-actions",children:[c.igUrl&&e.jsxs(e.Fragment,{children:[e.jsxs("a",{href:c.igUrl,target:"_blank",rel:"noopener noreferrer",className:"view-link-btn",children:[e.jsx(nt,{size:16})," é–‹å•Ÿ IG"]}),d&&e.jsxs("button",{className:"view-sync-btn",onClick:za,disabled:se(c.id),title:"é‡æ–°æŠ“å– IG è³‡æ–™",children:[e.jsx(Ne,{size:16,className:se(c.id)?"spinning":""}),se(c.id)?"åŒæ­¥ä¸­...":"åŒæ­¥"]})]}),e.jsx("button",{className:"view-edit-btn",onClick:Da,children:"âœï¸ ç·¨è¼¯"})]})]})]}),e.jsx("button",{className:"post-nav-side next",onClick:a=>{a.stopPropagation(),Pa()},disabled:xe()>=N.length-1,title:"ä¸‹ä¸€å‰‡",children:e.jsx(it,{size:32})})]}),wa&&e.jsx("div",{className:"modal-overlay",onClick:()=>z(!1),children:e.jsxs("div",{className:"social-modal",onClick:a=>a.stopPropagation(),children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h2",{children:S?"ç·¨è¼¯å‚™ä»½":"æ–°å¢žå‚™ä»½"}),e.jsx("button",{className:"close-btn",onClick:()=>z(!1),children:e.jsx(ce,{size:20})})]}),e.jsxs("div",{className:"modal-body",children:[e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{children:[e.jsx(ua,{size:14})," IG é€£çµ","ï¼ˆè‡ªå‹•æŠ“å–ï¼‰"]}),e.jsxs("div",{className:"ig-url-input",children:[e.jsx("input",{type:"url",placeholder:"è²¼ä¸Š Instagram é€£çµï¼Œè‡ªå‹•æŠ“å–åœ–ç‰‡å’Œæ–‡å­—...",value:p.igUrl,onChange:a=>v(s=>({...s,igUrl:a.target.value})),onBlur:Je,disabled:je}),e.jsx("button",{onClick:Je,title:"æŠ“å–è³‡æ–™",disabled:je,children:je?e.jsx("span",{className:"fetching-spinner"}):e.jsx(ma,{size:16})}),Ke&&e.jsx("span",{className:"fetch-progress",children:Ke})]})]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"é¡žåž‹"}),e.jsx("div",{className:"type-selector",children:F.map(a=>e.jsxs("button",{className:p.type===a.id?"active":"",style:p.type===a.id?{background:a.color}:{},onClick:()=>v(s=>({...s,type:a.id})),children:[a.icon," ",a.label]},a.id))})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"æˆå“¡"}),e.jsx("select",{value:p.member,onChange:a=>v(s=>({...s,member:a.target.value})),children:Se.map(a=>e.jsx("option",{value:a.name,children:a.name},a.name))})]})]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{children:[e.jsx(lt,{size:14})," ç™¼æ–‡æ—¥æœŸ"]}),e.jsx("input",{type:"date",value:p.date,onChange:a=>v(s=>({...s,date:a.target.value}))})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"æ™‚é–“ï¼ˆé¸å¡«ï¼‰"}),e.jsx("input",{type:"time",value:p.time,onChange:a=>v(s=>({...s,time:a.target.value}))})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{children:[e.jsx(rt,{size:14})," åœ–ç‰‡/å½±ç‰‡",qe>0&&e.jsxs("span",{className:"upload-status",children:["ï¼ˆ",qe," å¼µä¸Šå‚³ä¸­...ï¼‰"]})]}),e.jsxs("div",{className:"media-upload-area",children:[p.media.map((a,s)=>{var t;const n=S&&((t=M[S.id])==null?void 0:t.includes(s));return e.jsxs("div",{className:`media-preview ${a.uploading?"uploading":""} ${a.uploadFailed?"failed":""} ${n?"broken":""}`,children:[a.type==="youtube"?e.jsxs("div",{className:"video-preview-img",children:[e.jsx("img",{src:a.thumbnail||ke(a.url),alt:""}),e.jsx(V,{size:16,className:"play-icon"})]}):a.type==="video"?a.thumbnail?e.jsxs("div",{className:"video-preview-img",children:[e.jsx("img",{src:a.thumbnailBackupUrl||a.thumbnail,alt:""}),e.jsx(V,{size:16,className:"play-icon"})]}):e.jsxs("div",{className:"video-preview-auto",children:[e.jsx("video",{src:a.backupUrl||a.url,muted:!0,preload:"metadata"}),e.jsx(V,{size:16,className:"play-icon"})]}):e.jsx("img",{src:a.backupUrl||a.url,alt:""}),a.uploading&&e.jsx("div",{className:"upload-overlay",children:e.jsx("div",{className:"mini-spinner"})}),a.uploadFailed&&e.jsx("div",{className:"upload-failed-badge",title:"ä¸Šå‚³å¤±æ•—ï¼Œå°‡ä½¿ç”¨åŽŸå§‹é€£çµ",children:"âš ï¸"}),n&&e.jsx("div",{className:"broken-image-badge",title:"æ­¤åœ–ç‰‡å·²æå£žï¼Œè«‹é‡æ–°ä¸Šå‚³",children:e.jsx(we,{size:14})}),e.jsx("button",{className:"remove-media",onClick:()=>Fa(s),children:e.jsx(ce,{size:14})})]},s)}),e.jsxs("label",{className:"upload-btn",children:[e.jsx("input",{type:"file",accept:"image/*,video/*",multiple:!0,onChange:Oa,disabled:Ee}),Ee?e.jsx("span",{className:"uploading",children:"ä¸Šå‚³ä¸­..."}):e.jsxs(e.Fragment,{children:[e.jsx(ct,{size:20}),e.jsx("span",{children:"ä¸Šå‚³"})]})]}),e.jsxs("button",{type:"button",className:"manual-url-toggle",onClick:()=>Y(!Xe),children:[e.jsx(ma,{size:16}),e.jsx("span",{children:"è²¼ä¸Šç¶²å€"})]})]}),Xe&&e.jsxs("div",{className:"manual-url-input",children:[e.jsx("p",{className:"manual-hint",children:"ðŸ’¡ æç¤ºï¼šæ”¯æ´åœ–ç‰‡ã€å½±ç‰‡ã€YouTube é€£çµï¼Œæ¯è¡Œä¸€å€‹"}),e.jsx("textarea",{placeholder:`è²¼ä¸Šåœ–ç‰‡/å½±ç‰‡/YouTube ç¶²å€ï¼Œæ¯è¡Œä¸€å€‹...
ä¾‹å¦‚ï¼š
https://scontent-xxx.cdninstagram.com/...jpg
https://www.youtube.com/watch?v=xxxxx`,value:ye,onChange:a=>ve(a.target.value),rows:4}),e.jsxs("div",{className:"manual-actions",children:[e.jsx("button",{type:"button",className:"cancel-manual",onClick:()=>{Y(!1),ve("")},children:"å–æ¶ˆ"}),e.jsx("button",{type:"button",className:"submit-manual",onClick:_a,children:"æ–°å¢žåª’é«”"})]})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"åŽŸæ–‡å…§å®¹"}),e.jsx("textarea",{placeholder:"è²¼ä¸Š IG åŽŸæ–‡å…§å®¹...",value:p.caption,onChange:a=>v(s=>({...s,caption:a.target.value})),rows:4})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"å‚™è¨»ï¼ˆé¸å¡«ï¼‰"}),e.jsx("textarea",{placeholder:"å…¶ä»–å‚™è¨»...",value:p.notes,onChange:a=>v(s=>({...s,notes:a.target.value})),rows:2})]})]}),e.jsxs("div",{className:"modal-footer",children:[S&&e.jsxs("button",{className:"delete-btn",onClick:()=>{Ga(S.id),z(!1)},children:[e.jsx(ot,{size:16})," åˆªé™¤"]}),e.jsx("button",{className:"cancel-btn",onClick:()=>z(!1),children:"å–æ¶ˆ"}),e.jsxs("button",{className:"save-btn",onClick:La,disabled:$e,children:[e.jsx(dt,{size:16})," ",$e?"å„²å­˜ä¸­...":"å„²å­˜"]})]})]})}),E&&O.length>0&&e.jsxs("div",{className:"batch-action-bar",children:[e.jsxs("span",{className:"batch-count",children:["å·²é¸å– ",O.length," ç­†"]}),e.jsxs("div",{className:"batch-actions",children:[!Le&&e.jsx("button",{className:"batch-cancel-btn",onClick:()=>G([]),children:"å–æ¶ˆé¸å–"}),Le?e.jsxs("button",{className:"batch-stop-btn",onClick:Va,children:[e.jsx(ce,{size:16}),"å–æ¶ˆåŒæ­¥ (",Re.current,"/",Re.total,")"]}):e.jsxs("button",{className:"batch-sync-btn",onClick:Wa,children:[e.jsx(Ne,{size:16}),"åŒæ­¥æŠ“å–"]})]})]}),X&&e.jsxs("div",{className:`toast ${X.type}`,children:[X.type==="error"?e.jsx(ut,{size:16}):e.jsx(mt,{size:16}),X.msg]}),I&&e.jsx("div",{className:"confirm-modal-overlay",onClick:I.onCancel,children:e.jsxs("div",{className:`confirm-modal confirm-modal-${I.type}`,onClick:a=>a.stopPropagation(),children:[e.jsx("h3",{className:"confirm-modal-title",children:I.title}),e.jsx("div",{className:"confirm-modal-body",children:I.content}),e.jsxs("div",{className:"confirm-modal-actions",children:[e.jsx("button",{className:"confirm-modal-cancel",onClick:I.onCancel,children:I.cancelText}),e.jsx("button",{className:`confirm-modal-confirm confirm-modal-confirm-${I.type}`,onClick:I.onConfirm,children:I.confirmText})]})]})})]})}const Ut=m.memo(vt);export{Ut as default};
